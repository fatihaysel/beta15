module.exports=function(t){var a={};function e(s){if(a[s])return a[s].exports;var n=a[s]={i:s,l:!1,exports:{}};return t[s].call(n.exports,n,n.exports,e),n.l=!0,n.exports}return e.m=t,e.c=a,e.d=function(t,a,s){e.o(t,a)||Object.defineProperty(t,a,{enumerable:!0,get:s})},e.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},e.t=function(t,a){if(1&a&&(t=e(t)),8&a)return t;if(4&a&&"object"==typeof t&&t&&t.__esModule)return t;var s=Object.create(null);if(e.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:t}),2&a&&"string"!=typeof t)for(var n in t)e.d(s,n,function(a){return t[a]}.bind(null,n));return s},e.n=function(t){var a=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(a,"a",a),a},e.o=function(t,a){return Object.prototype.hasOwnProperty.call(t,a)},e.p="",e(e.s=20)}([function(t,a){t.exports=flarum.core.compat["components/Button"]},,,function(t,a){t.exports=flarum.core.compat["components/Alert"]},,,,,,,,,,,function(t,a){t.exports=flarum.core.compat["components/ExtensionPage"]},function(t,a){t.exports=flarum.core.compat["components/LoadingIndicator"]},function(t,a){t.exports=flarum.core.compat["utils/saveSettings"]},function(t,a){t.exports=flarum.core.compat["utils/Stream"]},function(t,a){t.exports=flarum.core.compat["components/UploadImageButton"]},,function(t,a,e){"use strict";function s(t,a){t.prototype=Object.create(a.prototype),t.prototype.constructor=t,t.__proto__=a}e.r(a);var n=e(14),r=e.n(n),o=e(0),i=e.n(o),l=e(3),p=e.n(l),u=e(15),c=e.n(u),d=e(16),v=e.n(d),f=e(17),h=e.n(f);function g(){return(g=Object.assign||function(t){for(var a=1;a<arguments.length;a++){var e=arguments[a];for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&(t[s]=e[s])}return t}).apply(this,arguments)}var b=e(18);var w=function(t){s(e,t);var a;a=e;function e(){return t.apply(this,arguments)||this}var n=e.prototype;return n.view=function(a){return a.attrs.loading=this.loading,a.attrs.className=(this.attrs.className||"")+" Button",app.data.settings["askvortsov-pwa.icon_"+this.attrs.name+"_path"]?(a.attrs.onclick=this.remove.bind(this),m("div",null,m("p",null,m("img",{src:app.forum.attribute("basePath").trimRight("/")+"/assets/"+app.data.settings["askvortsov-pwa.icon_"+this.attrs.name+"_path"]+"?"+performance.now(),alt:""})),m("p",null,i.a.prototype.view.call(this,g({},a,{children:app.translator.trans("core.admin.upload_image.remove_button")}))))):(a.attrs.onclick=this.upload.bind(this),t.prototype.view.call(this,a))},n.resourceUrl=function(){return app.forum.attribute("apiUrl")+"/pwa/logo/"+this.attrs.name},e}(e.n(b).a);var _=function(t){s(e,t);var a;a=e;function e(){return t.apply(this,arguments)||this}var n=e.prototype;return n.oninit=function(a){t.prototype.oninit.call(this,a),this.saving=!1,this.refresh()},n.refresh=function(){var t=this;this.loading=!0;var a=app.data.settings;this.status_messages=[],this.manifest={},this.sizes=[],this.values={},this.fields=["askvortsov-pwa.longName","askvortsov-pwa.backgroundColor"],this.fields.forEach((function(e){return t.values[e]=h()(void 0!==a[e]?a[e]:"")})),app.request({method:"GET",url:app.forum.attribute("apiUrl")+"/pwa/settings"}).then((function(a){t.manifest=a.data.attributes.manifest,t.sizes=a.data.attributes.sizes,t.status_messages=a.data.attributes.status_messages,t.loading=!1,m.redraw()}))},n.checkExistence=function(t){var a=new XMLHttpRequest;return a.open("HEAD",t,!1),a.send(),404!=a.status},n.content=function(){return this.loading||this.saving?m("div",{className:"PWAPage"},m("div",{className:"container"},m(c.a,null))):m("div",{className:"PWAPage"},m("div",{className:"container"},m("form",{onsubmit:this.onsubmit.bind(this)},m("h2",null,app.translator.trans("askvortsov-pwa.admin.pwa.heading")),m("div",{className:"helpText"},app.translator.trans("askvortsov-pwa.admin.pwa.text")),m("div",{class:"statusCheck"},m("legend",null,app.translator.trans("askvortsov-pwa.admin.pwa.status_check_heading")),this.status_messages.map((function(t){return m(p.a,{type:t.type,dismissible:!1},[t.message])}))),m("fieldset",{class:"parent"},m("fieldset",null,m("legend",null,app.translator.trans("askvortsov-pwa.admin.pwa.about.heading")),m("div",{className:"helpText"},app.translator.trans("askvortsov-pwa.admin.pwa.about.short_name_text")),m("input",{className:"FormControl",value:this.manifest.short_name,disabled:!0})),m("fieldset",null,m("div",{className:"helpText"},app.translator.trans("askvortsov-pwa.admin.pwa.about.name_text")),m("input",{className:"FormControl",bidi:this.values["askvortsov-pwa.longName"],required:!0})),m("fieldset",null,m("div",{className:"helpText"},app.translator.trans("askvortsov-pwa.admin.pwa.about.description_text")),m("textarea",{className:"FormControl",value:this.manifest.description,disabled:!0},this.manifest.description))),m("fieldset",{class:"parent"},m("fieldset",null,m("legend",null,app.translator.trans("askvortsov-pwa.admin.pwa.colors.heading")),m("div",{className:"helpText"},app.translator.trans("askvortsov-pwa.admin.pwa.colors.theme_color_text")),m("input",{className:"FormControl",type:"text",placeholder:"#aaaaaa",value:this.manifest.theme_color,disabled:!0})),m("fieldset",null,m("div",{className:"helpText"},app.translator.trans("askvortsov-pwa.admin.pwa.colors.background_color_text")),m("input",{className:"FormControl",type:"text",placeholder:"#aaaaaa",bidi:this.values["askvortsov-pwa.backgroundColor"],required:!0}))),m(i.a,{type:"submit",className:"Button Button--primary"},app.translator.trans("askvortsov-pwa.admin.pwa.submit_button")),m("fieldset",null,m("legend",null,app.translator.trans("askvortsov-pwa.admin.pwa.logo_heading")),m("div",{className:"helpText"},app.translator.trans("askvortsov-pwa.admin.pwa.logo_text")),this.sizes.map((function(t){return m("fieldset",{class:"logoFieldset"},m(w,{name:t}),m("div",{className:"helpText"},app.translator.trans("askvortsov-pwa.admin.pwa.logo_size_text",{size:t})))}))))))},n.onsubmit=function(t){t.preventDefault();/^#[0-9a-f]{3}([0-9a-f]{3})?$/i.test(this.values["askvortsov-pwa.backgroundColor"]())?this.saveSettings():alert(app.translator.trans("core.admin.appearance.enter_hex_message"))},n.saveSettings=function(){var t=this;if(!this.saving){this.saving=!0,app.alerts.dismiss(this.successAlert);var a={};this.fields.forEach((function(e){return a[e]=t.values[e]()})),v()(a).then((function(){t.successAlert=app.alerts.show({type:"success"},app.translator.trans("core.admin.basics.saved_message"))})).catch((function(){})).then((function(){t.saving=!1,t.refresh()}))}},e}(r.a);app.initializers.add("askvortsov/flarum-pwa",(function(){app.extensionData.for("askvortsov-pwa").registerPage(_)}))}]);
//# sourceMappingURL=admin.js.map